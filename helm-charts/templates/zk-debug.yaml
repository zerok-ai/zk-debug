apiVersion: v1
kind: ConfigMap
metadata:
  name: zk-debug
  labels:
  {{- include "zk-debug.labels" . | nindent 4 }}
data:
  webdis.json: |+  
    {
      "redis_host": "redis-master.zk-client.svc.cluster.local",
      "redis_port": 6379,
      "redis_auth": {{quote .Values.zkDebug.redisAuth }},
      "http_host":  "0.0.0.0",
      "http_port":  7379,
      "threads":  4,
      "daemonize": false,
      "database": 0,
      "acl": [
        {
          "disabled": ["DEBUG"]
        },
        {
          "http_basic_auth":  "user:password",
          "enabled":    ["DEBUG"]
        }
      ],
      "hiredis": {
        "keep_alive_sec": 15
      },
      "verbosity": 3,
      "logfile": "/var/log/webdis.log"
    }

---
apiVersion: v1
kind: Service
metadata:
  name: zk-debug
  labels:
  {{- include "zk-debug.labels" . | nindent 4 }}
spec:
  type: {{ .Values.zkDebug.type }}
  selector:
    app: zk-debug
  {{- include "zk-debug.selectorLabels" . | nindent 4 }}
  ports:
	{{- .Values.zkDebug.ports | toYaml | nindent 2 -}}
  